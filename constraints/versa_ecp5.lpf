# ECP5-5G Versa Development Kit Constraints
# Board: LFE5UM5G-45F-VERSA-EVN
# Device: LFE5UM5G-45F-8BG381C
# Project: Intel 8008 Vintage CPU Implementation

# ====================================================================================
# Clock Inputs
# ====================================================================================

# 100 MHz LVDS Oscillator (X1) - General Purpose Clock
# Bank 6 - Connects to PCLKT6_0/PCLKC6_0
LOCATE COMP "clk" SITE "P3";
IOBUF PORT "clk" IO_TYPE=LVDS;

# ====================================================================================
# Reset (using a button or switch)
# ====================================================================================

# Using SW3-1 as reset (active high when switch is up)
# Bank 7 - 1.5V
LOCATE COMP "rst" SITE "H2";
IOBUF PORT "rst" IO_TYPE=LVCMOS15;

# ====================================================================================
# Intel 8008 CPU Interface - Signals FROM the real 8008 chip
# ====================================================================================
# These signals come FROM the 8008 and are INPUTS to the FPGA glue logic

# 8008 Data Bus (D0-D7) - Bidirectional 8-bit bus
# Used for data transfer AND address output during T1/T2 states
# LOCATE COMP "cpu_d[0]" SITE "TBD";
# IOBUF PORT "cpu_d[0]" IO_TYPE=LVCMOS33;
# ... (continue for cpu_d[1] through cpu_d[7])

# 8008 State Outputs (S0, S1, S2) - Indicate current machine cycle type
# These are decoded to determine memory read/write, I/O, interrupt, etc.
# LOCATE COMP "cpu_s0" SITE "TBD";
# IOBUF PORT "cpu_s0" IO_TYPE=LVCMOS33;
# LOCATE COMP "cpu_s1" SITE "TBD";
# IOBUF PORT "cpu_s1" IO_TYPE=LVCMOS33;
# LOCATE COMP "cpu_s2" SITE "TBD";
# IOBUF PORT "cpu_s2" IO_TYPE=LVCMOS33;

# 8008 SYNC Output - Goes high during T1 and T2 states (address output time)
# LOCATE COMP "cpu_sync" SITE "TBD";
# IOBUF PORT "cpu_sync" IO_TYPE=LVCMOS33;

# ====================================================================================
# Intel 8008 CPU Interface - Signals TO the real 8008 chip
# ====================================================================================
# These signals are generated by FPGA glue logic and sent TO the 8008

# Phase Clocks (φ1 and φ2) - Two-phase non-overlapping clocks
# These MUST be non-overlapping! Generated by phase_clocks module.
LOCATE COMP "cpu_phi1" SITE "B12";
IOBUF PORT "cpu_phi1" IO_TYPE=LVCMOS33;
LOCATE COMP "cpu_phi2" SITE "E7";
IOBUF PORT "cpu_phi2" IO_TYPE=LVCMOS33;

# READY Input - Wait state control (active high)
# When low, 8008 enters wait states. Generated by ready_generator module.
# LOCATE COMP "cpu_ready" SITE "TBD";
# IOBUF PORT "cpu_ready" IO_TYPE=LVCMOS33;

# INTERRUPT Input - Interrupt request (active high)
# Sampled during T1I and T2I states. Generated by interrupt_logic module.
# LOCATE COMP "cpu_interrupt" SITE "TBD";
# IOBUF PORT "cpu_interrupt" IO_TYPE=LVCMOS33;

# ====================================================================================
# Memory Interface - Managed by memory_controller module
# ====================================================================================
# These connect to external RAM/ROM chips (or FPGA block RAM)

# Memory Address Bus (14-bit) - Latched from 8008 data bus during T1/T2
# LOCATE COMP "mem_addr[0]" SITE "TBD";
# IOBUF PORT "mem_addr[0]" IO_TYPE=LVCMOS33;
# ... (continue for mem_addr[1] through mem_addr[13])

# Memory Data Bus (8-bit) - Separate from 8008 data bus
# LOCATE COMP "mem_data[0]" SITE "TBD";
# IOBUF PORT "mem_data[0]" IO_TYPE=LVCMOS33;
# ... (continue for mem_data[1] through mem_data[7])

# Memory Control Signals
# LOCATE COMP "mem_read_n" SITE "TBD";   # Memory read enable (active low)
# IOBUF PORT "mem_read_n" IO_TYPE=LVCMOS33;
# LOCATE COMP "mem_write_n" SITE "TBD";  # Memory write enable (active low)
# IOBUF PORT "mem_write_n" IO_TYPE=LVCMOS33;
# LOCATE COMP "rom_cs_n" SITE "TBD";     # ROM chip select (active low)
# IOBUF PORT "rom_cs_n" IO_TYPE=LVCMOS33;
# LOCATE COMP "ram_cs_n" SITE "TBD";     # RAM chip select (active low)
# IOBUF PORT "ram_cs_n" IO_TYPE=LVCMOS33;

# ====================================================================================
# I/O Interface - Managed by io_controller module
# ====================================================================================
# I/O port connections

# I/O Address (5-bit for 8008 - allows 32 ports)
# LOCATE COMP "io_addr[0]" SITE "TBD";
# IOBUF PORT "io_addr[0]" IO_TYPE=LVCMOS33;
# ... (continue for io_addr[1] through io_addr[4])

# I/O Data Bus
# LOCATE COMP "io_data[0]" SITE "TBD";
# IOBUF PORT "io_data[0]" IO_TYPE=LVCMOS33;
# ... (continue for io_data[1] through io_data[7])

# I/O Control Signals
# LOCATE COMP "io_read_n" SITE "TBD";    # I/O read enable (active low)
# IOBUF PORT "io_read_n" IO_TYPE=LVCMOS33;
# LOCATE COMP "io_write_n" SITE "TBD";   # I/O write enable (active low)
# IOBUF PORT "io_write_n" IO_TYPE=LVCMOS33;

# ====================================================================================
# Debug Outputs - General Purpose LEDs (Bank 2 - 2.5V)
# Use these for debugging internal signals
# Note: LEDs are ACTIVE LOW (illuminate when driven to '0')
# ====================================================================================

# LED0 - D25 (Yellow)
LOCATE COMP "debug_led[0]" SITE "E16";
IOBUF PORT "debug_led[0]" IO_TYPE=LVCMOS25;

# LED1 - D24 (Yellow)
LOCATE COMP "debug_led[1]" SITE "D17";
IOBUF PORT "debug_led[1]" IO_TYPE=LVCMOS25;

# LED2 - D22 (Green)
LOCATE COMP "debug_led[2]" SITE "D18";
IOBUF PORT "debug_led[2]" IO_TYPE=LVCMOS25;

# LED3 - D21 (Green)
LOCATE COMP "debug_led[3]" SITE "E18";
IOBUF PORT "debug_led[3]" IO_TYPE=LVCMOS25;

# LED4 - D26 (Red)
LOCATE COMP "debug_led[4]" SITE "F17";
IOBUF PORT "debug_led[4]" IO_TYPE=LVCMOS25;

# LED5 - D27 (Red)
LOCATE COMP "debug_led[5]" SITE "F18";
IOBUF PORT "debug_led[5]" IO_TYPE=LVCMOS25;

# LED6 - D28 (Red)
LOCATE COMP "debug_led[6]" SITE "E17";
IOBUF PORT "debug_led[6]" IO_TYPE=LVCMOS25;

# LED7 - D29 (Red)
LOCATE COMP "debug_led[7]" SITE "F16";
IOBUF PORT "debug_led[7]" IO_TYPE=LVCMOS25;

# ====================================================================================
# DIP Switches (SW3) - User Input
# Use these for configuration or test inputs
# ====================================================================================

# SW3-1 (Bank 7 - 1.5V) - Already used for reset above
# LOCATE COMP "sw[0]" SITE "H2";
# IOBUF PORT "sw[0]" IO_TYPE=LVCMOS15;

# SW3-2 (Bank 7 - 1.5V)
LOCATE COMP "sw[1]" SITE "K3";
IOBUF PORT "sw[1]" IO_TYPE=LVCMOS15;

# SW3-3 (Bank 7 - 1.5V)
LOCATE COMP "sw[2]" SITE "G3";
IOBUF PORT "sw[2]" IO_TYPE=LVCMOS15;

# SW3-4 (Bank 7 - 1.5V)
LOCATE COMP "sw[3]" SITE "F2";
IOBUF PORT "sw[3]" IO_TYPE=LVCMOS15;

# SW3-5 (Bank 2 - 2.5V)
LOCATE COMP "sw[4]" SITE "J18";
IOBUF PORT "sw[4]" IO_TYPE=LVCMOS25;

# SW3-6 (Bank 2 - 2.5V)
LOCATE COMP "sw[5]" SITE "K18";
IOBUF PORT "sw[5]" IO_TYPE=LVCMOS25;

# SW3-7 (Bank 2 - 2.5V)
LOCATE COMP "sw[6]" SITE "K19";
IOBUF PORT "sw[6]" IO_TYPE=LVCMOS25;

# SW3-8 (Bank 2 - 2.5V)
LOCATE COMP "sw[7]" SITE "K20";
IOBUF PORT "sw[7]" IO_TYPE=LVCMOS25;

# ====================================================================================
# Configuration
# ====================================================================================

# These apply to the entire design
SYSCONFIG CONFIG_IOVOLTAGE=3.3 COMPRESS_CONFIG=ON MCCLK_FREQ=62;

# ====================================================================================
# Notes
# ====================================================================================
#
# This constraints file provides basic mappings for the Intel 8008 implementation.
# As you develop modules, uncomment and assign the appropriate pins for:
#   - Data bus (8-bit bidirectional)
#   - Address bus (14-bit output)
#   - Control signals (S0, S1, S2, SYNC, READY, INTERRUPT)
#
# The debug LEDs and switches are fully mapped and ready to use for testing.
#
# Refer to the ECP5-5G Versa Development Kit User Guide for complete pin listings:
# https://www.latticesemi.com/products/developmentboardsandkits/ecp55gversadevkit
#
